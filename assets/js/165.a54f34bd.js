(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{629:function(n,e,t){"use strict";t.r(e),e.default="<template>\n  <Form :form=\"form\">\n    <Field\n      name=\"address\"\n      title=\"地址选择\"\n      required\n      :decorator=\"[FormItem]\"\n      :component=\"[\n        Cascader,\n        {\n          style: {\n            width: '240px',\n          },\n        },\n      ]\"\n    />\n\n    <Submit @submit=\"onSubmit\">提交</Submit>\n  </Form>\n</template>\n\n<script>\nimport { createForm, onFieldReact } from '@formily/core'\nimport { Field } from '@formily/vue'\nimport { Form, FormItem, Cascader, Submit } from '@formily/view-design'\nimport { action } from '@formily/reactive'\nimport axios from 'axios'\n\nconst transformAddress = (data = {}) => {\n  return Object.entries(data).reduce((buf, [key, value]) => {\n    if (typeof value === 'string')\n      return buf.concat({\n        label: value,\n        value: key,\n      })\n    const { name, code, cities, districts } = value\n    const _cities = transformAddress(cities)\n    const _districts = transformAddress(districts)\n    return buf.concat({\n      label: name,\n      value: code,\n      children: _cities.length ? _cities : _districts.length ? _districts : [],\n    })\n  }, [])\n}\n\nconst useAddress = (pattern) => {\n  onFieldReact(pattern, (field) => {\n    field.loading = true\n    axios('//unpkg.com/china-location/dist/location.json')\n      .then((res) => res.data)\n      .then(\n        action((data) => {\n          field.dataSource = transformAddress(data)\n          field.loading = false\n        })\n      )\n  })\n}\n\nconst form = createForm({\n  effects: () => {\n    useAddress('address')\n  },\n})\n\nexport default {\n  components: { Form, Field, Submit },\n  data() {\n    return {\n      FormItem,\n      Cascader,\n      form,\n    }\n  },\n  methods: {\n    onSubmit(value) {\n      console.log(value)\n    },\n  },\n}\n<\/script>\n"}}]);